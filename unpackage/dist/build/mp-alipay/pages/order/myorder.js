(my["webpackJsonp"]=my["webpackJsonp"]||[]).push([["pages/order/myorder"],{"19f2":function(t,e,a){"use strict";(function(t){var i=a("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=i(a("2eee")),n=i(a("c973")),s=a("5804"),r={components:{Popup:function(){a.e("components/uni-popup").then(function(){return resolve(a("743f"))}.bind(null,a)).catch(a.oe)},uniLoadMore:function(){a.e("components/uni-load-more").then(function(){return resolve(a("78e2"))}.bind(null,a)).catch(a.oe)}},data:function(){return{state_text:"",text1:"补充信息可加速审核，大幅提高审核通过率",tokendata:"",checkboxValue1:[],checkboxList1:[{name:"押金过高",disabled:!1},{name:"更改订单信息",disabled:!1},{name:"预收押金/补押金",disabled:!1},{name:"审核时间过长",disabled:!1},{name:"商家没货/服务态度问题",disabled:!1},{name:"运费问题",disabled:!1}],showqx:!1,phoneHeight:0,scrollviewHigh:0,state_active:0,topRefresh:!1,listData:[],tabNumber:0,dataType:"all",isPayPopup:!1,pay_type:20,order_id:0,last_page:0,page:1,list_rows:10,no_more:!1,loading:!0,isCodeImg:!1,codeImg:"",showAlipay:!1,isfirst:!1}},onReachBottom:function(){this.page++,this.getData()},computed:{loadingType:function(){return this.loading?1:0!=this.listData.length&&this.no_more?2:0}},onLoad:function(t){"undefined"!=typeof t.dataType&&(this.dataType=t.dataType),"payment"==this.dataType?this.state_active=1:"received"==this.dataType?this.state_active=3:"comment"==this.dataType?this.state_active=4:"delivery"==this.dataType?this.state_active=2:"examine"==this.dataType?this.state_active=5:"haveInHand"==this.dataType?(this.state_active=6,this.tabNumber=170):"returned"==this.dataType?this.state_active=7:"Returning"==this.dataType?this.state_active=9:"cancel"==this.dataType?this.state_active=8:"complete"==this.dataType?(this.state_active=10,this.tabNumber=320):"yuqi"==this.dataType?this.state_active=12:"canceling"==this.dataType&&(this.state_active=13)},mounted:function(){this.init(),this.initData(),this.getData(),this.tokendata=t.getStorageSync("token"),console.log("tokendata",this.tokendata)},onShow:function(){this.isfirst&&(this.initData(),this.getData())},methods:{onGetAuthorize1:function(){var e=this;return(0,n.default)(o.default.mark((function a(){return o.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:my.getAuthCode({scopes:["auth_base"],success:function(a){my.getPhoneNumber({success:function(i){var o=i.response;o=JSON.parse(o);var n=o.response;e._post("user.usermp/mnpAlipayAuthLogin",{code:a.authCode,content:n},(function(a){t.setStorageSync("token",a.data.data.token),t.setStorageSync("user_id",a.data.data.user_id),t.showToast({title:"登录成功"}),e.getData(),e.tokendata=t.getStorageSync("token")}))},fail:function(t){console.log("失败"),reject(t)}})}});case 1:case"end":return a.stop()}}),a)})))()},onAuthError:function(){t.showModal({title:"提示",content:"取消授权，可能导致服务无法使用，或者页面显示不完整",success:function(t){t.confirm?console.log("取消授权"):console.log("重新授权")}})},gotoZhangdan:function(e){t.navigateTo({url:"/pages/order/CXbill?order_id="+e})},gotoExpress:function(t){this.gotoPage("/pages/order/express/express?order_id="+t)},queding:function(){var e=this,a=JSON.stringify(e.checkboxValue1),i="";i="待发货"==e.state_text?1:0,t.showLoading({title:"正在处理"}),e._get("user.order/cancel",{order_id:e.order_id,reason:a,status:i},(function(a){t.hideLoading(),t.showToast({title:"操作成功",duration:2e3,icon:"success"}),e.listData=[],e.showqx=!1,e.getData()}))},checkboxChange:function(){},close:function(){this.showqx=!1},qrz:function(e){t.navigateTo({url:"/pages/order/smrz?order_id="+e})},payyj:function(e){this._post("/order.order/pay",{order_id:e},(function(a){my.tradePay({orderStr:a.data,success:function(a){t.reLaunch({url:"/pages/order/order-detail?order_id="+e})},fail:function(e){t.showToast({title:"支付失败！",icon:"none"})}})}))},initData:function(){this.page=1,this.listData=[],this.no_more=!1},init:function(){var e=this;t.getSystemInfo({success:function(a){e.phoneHeight=a.windowHeight;var i=t.createSelectorQuery().in(e).select(".top-tabbar");i.boundingClientRect((function(t){var a=e.phoneHeight-t.height;e.scrollviewHigh=a})).exec()}})},earlyTermination:function(e){var a=this;this._post("/order.order/earlyEnd",{order_id:e},(function(e){if(124==e.code)return t.showToast({title:e.msg,icon:"none"}),a.listData=[],void a.getData();(0,s.pay)(e,a)}))},stateFunc:function(t){if(this.state_active!=t){switch(this.page=1,this.loading=!0,this.state_active=t,t){case 0:this.listData=[],this.dataType="all";break;case 1:this.listData=[],this.dataType="payment";break;case 2:this.listData=[],this.dataType="delivery";break;case 3:this.listData=[],this.dataType="received";break;case 4:this.listData=[],this.dataType="comment";break;case 5:this.listData=[],this.dataType="examine";break;case 6:this.listData=[],this.dataType="haveInHand";break;case 7:this.listData=[],this.dataType="returned";break;case 8:this.listData=[],this.dataType="cancel";break;case 9:this.listData=[],this.dataType="Returning";break;case 10:this.listData=[],this.dataType="complete";break;case 11:this.listData=[],this.dataType="reject";break;case 12:this.listData=[],this.dataType="yuqi";break;case 13:this.listData=[],this.dataType="canceling";break}this.getData()}},scrolltolowerFunc:function(){this.no_more||(this.page++,this.page<=this.last_page?this.getData():this.no_more=!0)},getData:function(){if(t.getStorageSync("token")){var e=this;e.loading=!0;var a=e.dataType;"yuqi"==a?e._get("user.order/yqlists",{page:e.page,pay_source:e.getPlatform(),list_rows:e.list_rows},(function(a){e.loading=!1,e.listData=e.listData.concat(a.data.list.data),e.last_page=a.data.list.last_page,a.data.list.last_page<=1?e.no_more=!0:e.no_more=!1,a.data.show_alipay&&(e.showAlipay=!0),e.isfirst=!0,t.stopPullDownRefresh()})):e._get("user.order/lists",{dataType:a,page:e.page,pay_source:e.getPlatform(),list_rows:e.list_rows},(function(a){e.loading=!1,e.listData=e.listData.concat(a.data.list.data),e.last_page=a.data.list.last_page,a.data.list.last_page<=1?e.no_more=!0:e.no_more=!1,a.data.show_alipay&&(e.showAlipay=!0),e.isfirst=!0,t.stopPullDownRefresh()}))}else this.loading=!1},gotoOrder:function(t){this.gotoPage("/pages/order/order-detail?order_id="+t)},returned:function(e){t.navigateTo({url:"./returned?order_id="+e})},hidePopupFunc:function(){this.isPayPopup=!1},toShop:function(t){this.gotoPage("/pages/shop/shop?shop_supplier_id="+t)},payTypeFunc:function(e){var a=this;a.isPayPopup=!1,t.showLoading({title:"加载中"}),a._post("user.order/pay",{payType:e,order_id:a.order_id,pay_source:a.getPlatform()},(function(t){(0,s.pay)(t,a)}))},onPayOrder:function(e){var a=this,i=1==a.balanceType?1:0,o={order_id:e,pay_source:a.getPlatform(),payType:30,use_balance:i};a._post("user.order/pay",o,(function(e){a.loading=!1,t.hideLoading(),(0,s.pay)(e,a,a.paySuccess,a.payError)}))},paySuccess:function(e){var a=this;30==a.order_type||40==a.order_type?a.showSuccess("支付成功",(function(){t.navigateBack()})):20==a.order_type?a.showSuccess("支付成功",(function(){a.gotoPage("/pages/user/my_shop/my_shop","reLaunch")})):a.gotoPage("/pages/order/pay-success/pay-success?order_id="+e.data.order_id[0],"reLaunch")},payError:function(e){30==this.order_type||40==this.order_type?t.navigateBack():20==this.order_type?this.gotoPage("/pages/user/my_shop/my_shop","redirect"):1==this.order_type&&t.showToast({title:"您取消了支付",icon:"none",success:function(){t.navigateBack()}})},orderReceipt:function(e){var a=this;t.showModal({title:"提示",content:"您确定要收货吗?",success:function(i){i.confirm?(t.showLoading({title:"正在处理"}),a._post("user.order/receipt",{order_id:e},(function(e){t.hideLoading(),t.showToast({title:e.msg,duration:2e3,icon:"success"}),a.listData=[],a.getData()}))):t.showToast({title:"取消收货",duration:1e3,icon:"none"})}})},bcxx:function(){t.navigateTo({url:"/pages/user/authentication"})},cancelOrder:function(t,e){console.log(e.state_text);this.order_id=t,this.state_text=e.state_text,this.showqx=!0},gotoEvaluate:function(t){this.gotoPage("/pages/order/evaluate/evaluate?order_id="+t)},onQRCode:function(e){var a=this;t.showLoading({title:"加载中"});var i=e,o=a.getPlatform();a._get("user.order/qrcode",{order_id:i,source:o},(function(e){t.hideLoading(),a.isCodeImg=!0,a.codeImg=e.data.qrcode}))},hideCodePopupFunc:function(){this.isCodeImg=!1},gotoAssembleShare:function(t){this.gotoPage("/pages/plus/assemble/fight-group-detail/fight-group-detail?assemble_bill_id="+t)}}};e.default=r}).call(this,a("c11b")["default"])},3971:function(t,e,a){"use strict";a.r(e);var i=a("19f2"),o=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(n);e["default"]=o.a},8815:function(t,e,a){"use strict";(function(t){var e=a("4ea4");a("a8db"),a("33db"),a("5c17");e(a("66fd"));var i=e(a("d5ac"));my.__webpack_require_UNI_MP_PLUGIN__=a,t(i.default)}).call(this,a("c11b")["createPage"])},"9f20":function(t,e,a){},d5ac:function(t,e,a){"use strict";a.r(e);var i=a("d5fa"),o=a("3971");for(var n in o)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return o[t]}))}(n);a("d5bb");var s=a("f0c5"),r=Object(s["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],void 0);e["default"]=r.exports},d5bb:function(t,e,a){"use strict";var i=a("9f20"),o=a.n(i);o.a},d5fa:function(t,e,a){"use strict";a.d(e,"b",(function(){return o})),a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){return i}));var i={uNoticeBar:function(){return Promise.all([a.e("common/vendor"),a.e("uni_modules/uview-ui/components/u-notice-bar/u-notice-bar")]).then(a.bind(null,"12b3"))},uIcon:function(){return Promise.all([a.e("common/vendor"),a.e("uni_modules/uview-ui/components/u-icon/u-icon")]).then(a.bind(null,"1d9f"))},uPopup:function(){return Promise.all([a.e("common/vendor"),a.e("uni_modules/uview-ui/components/u-popup/u-popup")]).then(a.bind(null,"a40d"))},uCheckboxGroup:function(){return Promise.all([a.e("common/vendor"),a.e("uni_modules/uview-ui/components/u-checkbox-group/u-checkbox-group")]).then(a.bind(null,"e797"))},uCheckbox:function(){return Promise.all([a.e("common/vendor"),a.e("uni_modules/uview-ui/components/u-checkbox/u-checkbox")]).then(a.bind(null,"4370"))}},o=function(){var t=this,e=t.$createElement,a=(t._self._c,t.theme()||""),i=t.theme(),o=t.__map(t.listData,(function(e,a){var i=t.__get_orig(e),o=(e.total_price-e.deposit-e.zhuanzujin).toFixed(2);return{$orig:i,g0:o}}));t.$mp.data=Object.assign({},{$root:{m0:a,m1:i,l0:o}})},n=[]}},[["8815","common/runtime","common/vendor"]]]);