(my["webpackJsonp"]=my["webpackJsonp"]||[]).push([["pages/order/order-detail"],{"351c":function(e,t,r){"use strict";r.r(t);var i=r("8299"),o=r.n(i);for(var a in i)["default"].indexOf(a)<0&&function(e){r.d(t,e,(function(){return i[e]}))}(a);t["default"]=o.a},"50a6":function(e,t,r){"use strict";r.r(t);var i=r("a663"),o=r("351c");for(var a in o)["default"].indexOf(a)<0&&function(e){r.d(t,e,(function(){return o[e]}))}(a);r("6b9e");var n=r("f0c5"),s=Object(n["a"])(o["default"],i["b"],i["c"],!1,null,"4a3e76c0",null,!1,i["a"],void 0);t["default"]=s.exports},"6b9e":function(e,t,r){"use strict";var i=r("8896"),o=r.n(i);o.a},8299:function(e,t,r){"use strict";(function(e,i){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r("5804"),a={data:function(){return{state_text:"",TotalPriceGoods:"",qurzshow:!0,timer:null,suiping:!1,payable:"",priceJg:"",checkboxValue1:[],checkboxList1:[{name:"押金过高",disabled:!1},{name:"更改订单信息",disabled:!1},{name:"预收押金/补押金",disabled:!1},{name:"审核时间过长",disabled:!1},{name:"商家没货/服务态度问题",disabled:!1},{name:"运费问题",disabled:!1}],showqx:!1,priceWF:"",start_time:"",end_time:"",buyOutPricedata:"",hasrenzheng_id:"",portrait:"",numTitol:"",loadding:!0,indicatorDots:!0,autoplay:!0,interval:2e3,duration:500,isPayPopup:!1,order_id:0,orderBill:[],detail:{order_status:[],address:{region:[]},product:[],pay_type:[],delivery_type:[],pay_status:[],buyOutPrice:""},extractStore:{},source:"user",service_open:0,service_type:10,isMpservice:!1,showAlipay:!1,user_id:0,expressList:[],express_id:"",express_name:"",express_no:"",status:1,cancel_refuse:"",pay_type:10}},components:{Popup:function(){r.e("components/uni-popup").then(function(){return resolve(r("743f"))}.bind(null,r)).catch(r.oe)},Mpservice:function(){r.e("components/mpservice/Mpservice").then(function(){return resolve(r("6d76"))}.bind(null,r)).catch(r.oe)}},onLoad:function(t){this.order_id=t.order_id,this.user_id=e.getStorageSync("user_id"),t.source&&(this.source=t.source)},mounted:function(){e.showLoading({title:"加载中"}),this.getData()},onShow:function(){},filters:{formatDate:function(e){var t=new Date(1e3*e),r=t.getFullYear(),i=t.getMonth()+1;i=i<10?"0"+i:i;var o=t.getDate();o=o<10?"0"+o:o;var a=t.getHours();a=a<10?"0"+a:a;var n=t.getMinutes();n=n<10?"0"+n:n;var s=t.getSeconds();return s=s<10?"0"+s:s,r+"-"+i+"-"+o}},methods:{close:function(){this.showqx=!1},fuzhi:function(t){e.setClipboardData({data:t,success:function(){e.showToast({title:"复制成功",icon:"none"})}})},qrz:function(t){e.navigateTo({url:"/pages/order/smrz?order_id="+t})},payyj:function(t){this._post("/order.order/pay",{order_id:t},(function(r){my.tradePay({orderStr:r.data,success:function(r){e.reLaunch({url:"/pages/order/order-detail?order_id="+t})},fail:function(t){e.showToast({title:"支付失败！",icon:"none"})}})}))},getData:function(){var t=this,r=t.order_id,i="user.order/detail";"supplier"==this.source&&(i="supplier.order/detail"),t._get(i,{order_id:r,pay_source:t.getPlatform()},(function(i){var o=0;i.data.order.hasrenzheng_id&&(o<10?t.timer=setInterval((function(){o+=1,o>3&&(clearInterval(t.timer),t.timer=null),t._post("order.authentication/queryAuthentication",{hasrenzheng_id:i.data.order.hasrenzheng_id},(function(e){1==e.code&&(clearInterval(t.timer),t.timer=null,t.qurzshow=!1)}))}),1e3):(clearInterval(t.timer),t.timer=null)),t.portrait=i.data.order.portrait,t.hasrenzheng_id=i.data.order.hasrenzheng_id,""==t.portrait&&""!=t.hasrenzheng_id&&t._post("order.authentication/queryAttestation",{flowid:t.hasrenzheng_id,order_id:r},(function(r){t.loading=!1,e.hideLoading()})),t.expressList=i.data.expressList,t.detail=i.data.order;var a=t.detail.product[0].product_attr;-1!=a.indexOf("不")?t.suiping=!1:t.suiping=!0,t.detail.buyOutPrice=i.data.buyOutPrice,t.start_time=t.detail.create_time;var n=t.detail.create_time;-1!=n.indexOf("2023")&&(t.end_time=n.replace(/2023/,"2024")),t.orderBill=i.data.orderBill,t.extractStore=i.data.order.extractStore,t.service_open=i.data.setting.service_open;var s=i.data.order.yushou,d=i.data.order.deposit,u=i.data.order.zhuanzujin,c=i.data.buyOutPrice;""==i.data.order.maiduan_no&&(c=0),2!=i.data.order.is_yushou&&(s=0),t.detail.TotalPriceGoods=(Number(t.detail.total_price)-Number(d)-Number(u)).toFixed(2),""==i.data.order.auth_no&&(d=0);Number(u),Number(d);for(var l=Number(d)+Number(s)+Number(u),p=i.data.orderBill,_=0,h=0,f=0,g=0;g<p.length;g++)1==p[g].is_pay_status&&(_=Number(_)+Number(p[g].price),null!=p[g].transaction_id&&(f=Number(f)+Number(p[g].price))),0==p[g].is_pay_status&&(h=Number(h)+Number(p[g].price)),0!=p[g].is_pay_status&&2!=p[g].is_pay_status||(g>=1&&1!=p[g-1].is_pay_status?p[g].xxx=!1:p[g].xxx=!0);t.priceWF=h.toFixed(2),t.numTitol=(Number(l)+Number(_)+Number(c)).toFixed(2),-1!=a.indexOf("不")?t.priceJg=Number(_).toFixed(2):2==t.detail.is_yushou?t.priceJg=Number(_+365).toFixed(2):t.priceJg=Number(_).toFixed(2),null==i.data.setting.mp_service?t.service_type=10:t.service_type=i.data.setting.mp_service.service_type,i.data.show_alipay&&(t.showAlipay=!0),t.loadding=!1,e.hideLoading()}))},returned:function(t){e.navigateTo({url:"./returned?order_id="+t})},submit:function(t){var r=this;r.loading=!0,e.showLoading({title:"加载中"}),r._post("/user.order/billPay",{bill_id:t},(function(t){r.loading=!1,e.hideLoading(),(0,o.pay)(t,r,r.paySuccess,r.payError)}))},maiduan:function(t){var r=this;r.loading=!0,e.showLoading({title:"加载中"}),r._post("/order.order/buyOut",{order_id:t},(function(t){r.loading=!1,e.hideLoading(),(0,o.pay)(t,r,r.paySuccess,r.payError)}))},hidePopupFunc:function(){this.isPayPopup=!1},queding:function(){var t=this,r=JSON.stringify(t.checkboxValue1);e.showLoading({title:"正在处理"});var i="";i="待发货"==t.state_text?1:0,t._get("user.order/cancel",{order_id:t.order_id,reason:r,status:i},(function(r){e.hideLoading(),e.showToast({title:"操作成功",duration:2e3,icon:"success"}),t.listData=[],t.showqx=!1,t.getData()}))},cancelOrder:function(e,t){console.log(t),this.state_text=t,this.order_id=e,this.showqx=!0},orderReceipt:function(t){var r=this;i.showModal({title:"提示",content:"您确定要收货吗?",success:function(i){i.confirm&&(e.showLoading({title:"正在处理"}),r._post("user.order/receipt",{order_id:t},(function(t){e.hideLoading(),e.showToast({title:t.msg,duration:2e3,icon:"success"}),r.getData()})))}})},earlyTermination:function(t){var r=this;e.showLoading({title:"正在加载"}),this._post("/order.order/earlyEnd",{order_id:t},(function(t){if(e.hideLoading(),124==t.code)return e.showToast({title:t.msg,icon:"none"}),void setTimeout((function(){e.navigateBack({delta:1})}),700);(0,o.pay)(t,r)}))},gotoExpress:function(e){this.gotoPage("/pages/order/express/express?order_id="+e)},onApplyRefund:function(e){this.gotoPage("/pages/order/refund/apply/apply?order_product_id="+e)},payTypeFunc:function(t){var r=this,i=r.order_id;r.isPayPopup=!1,e.showLoading({title:"加载中"}),r._post("user.order/pay",{payType:t,order_id:i,pay_source:r.getPlatform()},(function(t){e.hideLoading(),(0,o.pay)(t,r)}))},onPayOrder:function(e){this.gotoPage("/pages/order/cashier?order_type=1&order_id="+e)},gotoProduct:function(e){this.gotoPage("/pages/product/detail/detail?product_id="+e.product_id)},tochat:function(){10==this.service_type&&(this.isMpservice=!0),20==this.service_type&&this.gotoPage("/pages/plus/chat/chat?user_id="+this.detail.supplier.supplier_user_id+"&shop_supplier_id="+this.detail.supplier.shop_supplier_id+"&nickName="+this.detail.supplier.name+"&order_id="+this.order_id)},changeRadio:function(e){this.status=e.detail.value},Cancel:function(){var t=this;i.showModal({title:"提示",content:"您确定审核吗?",success:function(r){r.confirm&&(e.showLoading({title:"正在处理"}),t._post("supplier.order/confirmCancel",{order_id:t.detail.order_id,is_cancel:t.status,cancel_refuse:t.cancel_refuse},(function(r){e.hideLoading(),t.showSuccess(r.msg),t.getData()})))}})},changeSelect:function(e){this.express_name=this.expressList[e.detail.value].express_name,this.express_id=this.expressList[e.detail.value].express_id},sendPro:function(){var t=this;i.showModal({title:"提示",content:"您确定要发货吗?",success:function(r){r.confirm&&(e.showLoading({title:"正在处理"}),t._post("supplier.order/delivery",{order_id:t.detail.order_id,express_id:t.express_id,express_no:t.express_no},(function(r){e.hideLoading(),t.showSuccess(r.msg),t.getData()})))}})}}};t.default=a}).call(this,r("c11b")["default"],r("c11b")["default"])},8896:function(e,t,r){},a663:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return a})),r.d(t,"a",(function(){return i}));var i={uPopup:function(){return Promise.all([r.e("common/vendor"),r.e("uni_modules/uview-ui/components/u-popup/u-popup")]).then(r.bind(null,"a40d"))},uCheckboxGroup:function(){return Promise.all([r.e("common/vendor"),r.e("uni_modules/uview-ui/components/u-checkbox-group/u-checkbox-group")]).then(r.bind(null,"e797"))},uCheckbox:function(){return Promise.all([r.e("common/vendor"),r.e("uni_modules/uview-ui/components/u-checkbox/u-checkbox")]).then(r.bind(null,"4370"))}},o=function(){var e=this,t=e.$createElement,r=(e._self._c,e.loadding?null:e.theme()),i=e.loadding?null:e.theme(),o=e.loadding||10!=e.detail.order_status.value?null:e.__map(e.orderBill,(function(t,r){var i=e.__get_orig(t),o=e._f("formatDate")(t.repayment_date);return{$orig:i,f0:o}}));e.$mp.data=Object.assign({},{$root:{m0:r,m1:i,l0:o}})},a=[]},a8d6:function(e,t,r){"use strict";(function(e){var t=r("4ea4");r("a8db"),r("33db"),r("5c17");t(r("66fd"));var i=t(r("50a6"));my.__webpack_require_UNI_MP_PLUGIN__=r,e(i.default)}).call(this,r("c11b")["createPage"])}},[["a8d6","common/runtime","common/vendor"]]]);